---
phase: 02-core-social
plan: 11
type: execute
wave: 4
depends_on: ["02-04", "02-05", "02-07"]
files_modified:
  - src/app/(app)/prayer-wall/page.tsx
  - src/components/prayer/PrayerCard.tsx
  - src/components/prayer/PrayerComposer.tsx
  - src/components/prayer/PrayButton.tsx
  - src/components/prayer/PrayerFilters.tsx
  - src/components/prayer/PrayerTabs.tsx
  - src/components/prayer/AnsweredBadge.tsx
  - src/components/prayer/SupportersList.tsx
autonomous: true

must_haves:
  truths:
    - "Prayer wall page displays prayer requests in card-based layout (liquid glass styling)"
    - "Prayer wall has two tabs: Others' Prayers and My Prayers"
    - "My Prayers has sub-sections: My Requests and Prayers I've Joined"
    - "PrayerCard shows request text, author (or Anonymous), pray count, comment count, reactions"
    - "PrayButton shows 'Praying for you' with count, toggles on tap"
    - "Prayer requests support the same 6 reactions and comments as posts"
    - "Author can mark request as 'answered' with optional testimony"
    - "Answered badge displays on answered prayer cards"
    - "PrayerComposer allows creating prayer request with text, media, anonymous option"
    - "Prayer wall is hidden for positivity mode users"
  artifacts:
    - path: "src/app/(app)/prayer-wall/page.tsx"
      provides: "Prayer wall page with tabs, filters, and prayer list"
      exports: ["default"]
    - path: "src/components/prayer/PrayerCard.tsx"
      provides: "Prayer request card with liquid glass styling"
      exports: ["PrayerCard"]
    - path: "src/components/prayer/PrayerComposer.tsx"
      provides: "Full-screen prayer request composer"
      exports: ["PrayerComposer"]
    - path: "src/components/prayer/PrayButton.tsx"
      provides: "Praying for you toggle button with count"
      exports: ["PrayButton"]
  key_links:
    - from: "src/app/(app)/prayer-wall/page.tsx"
      to: "src/hooks/usePrayerWall.ts"
      via: "usePrayerWall hook for data"
      pattern: "usePrayerWall"
    - from: "src/components/prayer/PrayButton.tsx"
      to: "src/hooks/usePrayerToggle.ts"
      via: "usePrayerToggle for optimistic pray toggle"
      pattern: "usePrayerToggle"
---

<objective>
Build the prayer wall page UI with prayer cards, composer, pray button, filters, tabs, and liquid glass styling matching the existing daily content aesthetic.

Purpose: The prayer wall is a core faith-community feature and a separate content stream from the social feed. It's bible-mode only and drives daily engagement through intercessory prayer.
Output: 1 page, 7 components.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/02-core-social/02-CONTEXT.md
@.planning/phases/02-core-social/02-07-SUMMARY.md
@.planning/phases/02-core-social/02-04-SUMMARY.md
@.planning/phases/02-core-social/02-05-SUMMARY.md
@src/components/daily/CommentBottomSheet.tsx
@src/components/daily/ReactionBar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create prayer wall components (PrayerCard, PrayButton, AnsweredBadge, SupportersList, PrayerTabs, PrayerFilters)</name>
  <files>
    src/components/prayer/PrayerCard.tsx
    src/components/prayer/PrayButton.tsx
    src/components/prayer/PrayerTabs.tsx
    src/components/prayer/PrayerFilters.tsx
    src/components/prayer/AnsweredBadge.tsx
    src/components/prayer/SupportersList.tsx
  </files>
  <action>
    **src/components/prayer/PrayerCard.tsx:**
    - Props: prayer (enriched prayer object from API), currentUserId: number, onPrayerUpdate, onDelete
    - Always card-based layout (per CONTEXT: not affected by admin feed style toggle)
    - Liquid glass styling: bg-white/10 backdrop-blur-2xl border border-white/20 rounded-2xl p-4 (matching existing daily content aesthetic)
    - Layout:
      - Header: author avatar + display_name (or "Anonymous" if is_anonymous) + relative timestamp + '...' context menu
      - Body: prayer text, expandable with "Read more" if > 5 lines
      - Text with @mentions and #hashtags styled (same as feed posts)
      - Media carousel if media present (reuse MediaCarousel from 02-10)
      - AnsweredBadge if status='answered' (shown prominently)
      - If answered with testimony: show testimony text below badge
      - Action bar:
        - PrayButton (left) â€” "Praying for you" with count
        - Reaction button (opens PostReactionBar/Picker â€” same 6 emojis)
        - Comment button + count (opens PostCommentSheet)
        - Repost button (quote-repost to social feed)
      - Comment preview: top 1-2 comments
    - Context menu ('...'): Report, Block, Edit/Delete/Mark Answered (for author only)
    - Dark mode support with liquid glass adaptation

    **src/components/prayer/PrayButton.tsx:**
    - Props: prayerRequestId: number, initialPraying: boolean, initialCount: number
    - Uses usePrayerToggle hook
    - Displays: ðŸ™ icon + count (e.g., "23 praying")
    - When user has prayed: filled/highlighted state (e.g., bg-primary/20 text-primary)
    - When not prayed: outline state
    - Tap toggles pray status with optimistic update
    - Disabled while loading
    - cn() for styling

    **src/components/prayer/PrayerTabs.tsx:**
    - Props: activeTab ('others' | 'my_requests' | 'my_joined'), onTabChange
    - Two main tabs: "Others' Prayers" and "My Prayers"
    - My Prayers has dropdown or sub-tabs: "My Requests" | "Prayers I've Joined"
    - Active tab indicator
    - cn() for styling, liquid glass tab bar

    **src/components/prayer/PrayerFilters.tsx:**
    - Props: statusFilter ('all' | 'active' | 'answered'), onFilterChange
    - Filter chips/buttons: All, Active, Answered
    - Active filter highlighted
    - Small and unobtrusive (below tabs)

    **src/components/prayer/AnsweredBadge.tsx:**
    - Props: answeredAt?: Date
    - Renders a badge: "Answered" with checkmark icon
    - Green badge styling (bg-green-100 text-green-700 or similar)
    - Shows relative time since answered: "Answered 2 days ago"

    **src/components/prayer/SupportersList.tsx:**
    - Props: prayerRequestId: number, isAuthor: boolean
    - Only renders if isAuthor (per CONTEXT: author can see who prayed)
    - Fetches GET /api/prayer-requests/[id]/supporters
    - Shows list of user avatars + names
    - "X people are praying for you" header
    - Tappable -> navigate to user profile
    - Paginated with "Load more"
  </action>
  <verify>
    - `npm run build` passes
    - PrayerCard renders with liquid glass styling
    - PrayButton toggles and shows count
    - AnsweredBadge displays on answered prayers
  </verify>
  <done>Prayer wall components built: PrayerCard with liquid glass styling and all actions, PrayButton with optimistic toggle, PrayerTabs with Others/My sub-sections, PrayerFilters, AnsweredBadge, SupportersList for authors.</done>
</task>

<task type="auto">
  <name>Task 2: Build prayer wall page and prayer composer</name>
  <files>
    src/app/(app)/prayer-wall/page.tsx
    src/components/prayer/PrayerComposer.tsx
  </files>
  <action>
    **src/components/prayer/PrayerComposer.tsx:**
    - Full-screen composer (slides up, matching CONTEXT create flow design)
    - Props: isOpen, onClose, onSubmit, initialDraft?
    - Uses useDraft('prayer_request') for auto-save
    - Layout:
      - Header: "Prayer Request" title + close (X) button + Submit button
      - Textarea: placeholder "Share your prayer request..." (min 1 char, max 5000)
      - Media attachment row: camera/gallery buttons (up to 10 items)
      - Media preview: horizontal thumbnail strip of attached media
      - Options:
        - Privacy selector: Public / Followers Only / Private (radio or segmented control)
        - Anonymous toggle: "Post anonymously" switch
    - On submit:
      - POST to /api/prayer-requests
      - Clear draft on success
      - Call onSubmit callback
      - Close composer
    - Auto-save: on any text/option change, debounce save to draft API
    - Dark mode, cn() styling

    **src/app/(app)/prayer-wall/page.tsx:**
    - Replace existing placeholder page
    - Bible-mode gate: if user mode is 'positivity', show message "Prayer wall is available in Bible mode. Switch to Bible mode in Settings." with link to settings
    - Uses usePrayerWall hook for data
    - Layout:
      - Page header: "Prayer Wall" title
      - PrayerTabs (Others' Prayers / My Prayers)
      - PrayerFilters (All / Active / Answered)
      - Prayer list: scrollable list of PrayerCard components
      - Infinite scroll using useInfiniteScroll
      - Loading state: skeleton cards
      - Empty states per tab:
        - Others: "No prayer requests yet. Be the first to share a prayer request!"
        - My Requests: "You haven't shared any prayer requests yet."
        - My Joined: "You haven't joined any prayers yet. Tap 'Praying for you' on someone's request."
    - Floating action button (or integrated with center '+' from bottom nav) to open PrayerComposer
    - Pull-to-refresh support
  </action>
  <verify>
    - `npm run build` passes
    - Prayer wall page renders with tabs and prayer cards
    - Composer opens and creates prayer request
    - Bible-mode gate works (positivity users see appropriate message)
    - Infinite scroll and filtering work
  </verify>
  <done>Prayer wall page complete with tabs (Others/My Prayers with sub-sections), filters (All/Active/Answered), liquid glass prayer cards, infinite scroll, bible-mode gate, and full-screen prayer composer with auto-save drafts.</done>
</task>

</tasks>

<verification>
- Prayer wall displays prayer requests in liquid glass cards
- Tabs switch between Others/My Requests/My Joined
- Status filters work (All/Active/Answered)
- PrayButton toggles with optimistic update
- Composer creates prayer request with media and options
- Anonymous prayers show "Anonymous" to others
- Answered badge displays on answered prayers
- Supporters list visible to prayer author
- Positivity mode users see bible-mode gate
- Infinite scroll and pull-to-refresh work
</verification>

<success_criteria>
- Complete prayer wall UI with liquid glass aesthetic
- Tab-based navigation (Others, My Requests, My Joined)
- Prayer composer with auto-save drafts
- All prayer interactions (pray, react, comment, report)
- Bible-mode restriction enforced
- Anonymous prayer support
- Answered prayer display with testimony
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-social/02-11-SUMMARY.md`
</output>
