---
phase: 02-core-social
plan: 11
type: execute
wave: 4
depends_on: [02-07, 02-04, 02-05]
files_modified:
  - src/app/(app)/prayer-wall/page.tsx
  - src/components/prayer/PrayerCard.tsx
  - src/components/prayer/PrayerComposer.tsx
  - src/components/prayer/PrayButton.tsx
  - src/components/prayer/PrayerFilters.tsx
autonomous: false

must_haves:
  truths:
    - "User can view dedicated prayer wall page with prayer requests"
    - "User can create a prayer request from the prayer wall"
    - "User can tap 'Praying for you' and see count update"
    - "User can filter prayer wall by active/answered"
    - "Answered prayers show testimony if provided"
    - "Prayer cards display author, request, pray count, and status"
  artifacts:
    - path: "src/app/(app)/prayer-wall/page.tsx"
      provides: "Prayer wall page replacing placeholder"
      min_lines: 30
    - path: "src/components/prayer/PrayerCard.tsx"
      provides: "Prayer request card component"
      min_lines: 40
    - path: "src/components/prayer/PrayerComposer.tsx"
      provides: "Create prayer request modal"
      min_lines: 30
    - path: "src/components/prayer/PrayButton.tsx"
      provides: "Praying for you toggle button"
      min_lines: 15
  key_links:
    - from: "src/app/(app)/prayer-wall/page.tsx"
      to: "src/hooks/usePrayerWall.ts"
      via: "hook consumption"
      pattern: "usePrayerWall"
    - from: "src/components/prayer/PrayButton.tsx"
      to: "src/hooks/usePrayerWall.ts"
      via: "togglePray callback"
      pattern: "togglePray"
---

<objective>
Build the prayer wall page UI: PrayerCard, PrayerComposer, PrayButton, PrayerFilters, and replace the existing prayer wall placeholder page.

Purpose: The prayer wall is a unique differentiator for this faith-based platform. It provides a dedicated space for prayer requests with specific engagement mechanics (praying, marking answered).
Output: 1 page, 4 components.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-core-social/02-RESEARCH.md
@.planning/phases/02-core-social/02-07-SUMMARY.md

@src/app/(app)/prayer-wall/page.tsx
@src/hooks/usePrayerWall.ts
@src/hooks/useInfiniteScroll.ts
@src/components/social/LikeButton.tsx
@src/components/social/CommentSection.tsx
@src/components/social/ShareButton.tsx
@src/components/ui/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PrayerCard, PrayButton, and PrayerComposer components</name>
  <files>
    src/components/prayer/PrayerCard.tsx
    src/components/prayer/PrayButton.tsx
    src/components/prayer/PrayerComposer.tsx
  </files>
  <action>
    **src/components/prayer/PrayButton.tsx:**
    Toggle button for "Praying for you." Props: prayerRequestId, initialHasPrayed (boolean), initialPrayCount (number), onToggle callback. Shows folded hands icon (lucide-react HandHeart or HandCoins or use a custom pray icon ‚Äî check lucide for best match, or use "üôè" emoji in button text). When active (has prayed), button is highlighted (filled style). Shows pray count next to icon. Optimistic update on click (flip state, update count). Size prop for compact/normal.

    **src/components/prayer/PrayerCard.tsx:**
    Card component for a prayer request in the prayer wall. Props: prayer request object (post with prayer extension data), onPray, onMarkAnswered callbacks.

    Layout:
    - Header: Author avatar + name + relative time + privacy badge (if followers/private)
    - Body: Prayer request text
    - Status badge: "Active" (green) or "Answered" (gold/amber)
    - If answered: show answered_testimony in a highlighted block below the request
    - If answered: show "Answered on [date]"
    - Action bar: PrayButton, comment icon with count, ShareButton, three-dot menu (mark answered if own + active, report if other's)
    - If own prayer request and status is 'active': "Mark as Answered" option in menu opens a small modal/dialog to add optional testimony
    - Pray count displayed prominently: "N people praying"

    Use Card from UI library. Use cn(). Support dark mode.

    **src/components/prayer/PrayerComposer.tsx:**
    Modal for creating a prayer request. Simpler than PostComposer ‚Äî just needs:
    - Textarea for prayer request body (max 5000 chars)
    - Privacy selector: Public, Followers Only, Private (radio buttons)
    - Submit button
    - On submit: POST to /api/prayer-requests, close modal, call onCreated
    - Profanity rejection: inline error from API response
  </action>
  <verify>npm run build ‚Äî no TypeScript errors. Components render correctly.</verify>
  <done>PrayerCard displays prayer requests with status and actions. PrayButton toggles with count. PrayerComposer creates prayer requests with privacy selection.</done>
</task>

<task type="auto">
  <name>Task 2: Create PrayerFilters and prayer wall page</name>
  <files>
    src/components/prayer/PrayerFilters.tsx
    src/app/(app)/prayer-wall/page.tsx
  </files>
  <action>
    **src/components/prayer/PrayerFilters.tsx:**
    Filter bar for prayer wall. Props: currentStatus, onStatusChange.
    - Status tabs: "Active" | "Answered" | "All" ‚Äî horizontal pill buttons
    - Active state highlighted
    - Compact, sticky at top

    **src/app/(app)/prayer-wall/page.tsx:**
    Replace the existing placeholder. Layout:
    - Page header: "Prayer Wall" title
    - FAB or "New Prayer Request" button to open PrayerComposer
    - PrayerFilters (status tabs)
    - List of PrayerCard components
    - Uses usePrayerWall hook with status filter
    - Uses useInfiniteScroll for sentinel
    - Loading skeletons during fetch
    - Empty state: "No prayer requests yet. Be the first to share."
    - PrayerComposer modal

    'use client' directive.

    Wire up prayer actions:
    - PrayButton on each card calls usePrayerWall.togglePray()
    - Mark answered opens inline dialog, calls usePrayerWall.markAnswered()
    - New prayer request via PrayerComposer calls API then refreshes list
  </action>
  <verify>Navigate to /prayer-wall in browser. Verify prayer requests load, filter tabs work, pray button toggles.</verify>
  <done>Prayer wall page displays filterable prayer requests with create, pray, and mark-answered functionality.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Prayer wall page with prayer request cards, pray toggle, status filters, prayer composer, and mark-answered flow</what-built>
  <how-to-verify>
    1. Navigate to http://localhost:3000/prayer-wall
    2. Click "New Prayer Request" ‚Äî create a prayer request
    3. Verify PrayerCard shows with active status
    4. Tap "Praying for you" ‚Äî verify count increments
    5. Tap again ‚Äî verify count decrements (toggle)
    6. Switch to "Answered" tab ‚Äî should be empty
    7. Go back to "Active" ‚Äî mark own prayer as answered with testimony
    8. Switch to "Answered" ‚Äî verify answered prayer shows with testimony
    9. Verify infinite scroll loads more when scrolling
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
1. Prayer wall page loads with real prayer request data
2. PrayerCard displays author, content, pray count, status
3. PrayButton toggles with optimistic count update
4. Status filter (active/answered/all) works
5. PrayerComposer creates new prayer requests
6. Mark answered flow updates status and stores testimony
7. Infinite scroll loads next page
</verification>

<success_criteria>
- Prayer wall is a fully functional dedicated page
- Pray toggle is responsive with optimistic updates
- Status filtering correctly shows active vs answered requests
- Answered prayers display testimony
- PrayerComposer validates input and checks profanity
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-social/02-11-SUMMARY.md`
</output>
