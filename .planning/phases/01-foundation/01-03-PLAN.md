---
phase: 01-foundation
plan: 03
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - src/components/ui/Button.tsx
  - src/components/ui/Card.tsx
  - src/components/ui/Input.tsx
  - src/components/ui/Modal.tsx
  - src/components/ui/Skeleton.tsx
  - src/components/ui/Toast.tsx
  - src/components/ui/index.ts
  - src/components/common/LoadingSpinner.tsx
  - src/components/common/EmptyState.tsx
  - src/components/common/ErrorBoundary.tsx
  - src/lib/utils/cn.ts
autonomous: true

must_haves:
  truths:
    - "UI components render in both light and dark modes"
    - "Button component supports variants (primary, secondary, outline, ghost, danger) and sizes (sm, md, lg)"
    - "Input component integrates with react-hook-form via forwardRef"
    - "Toast system can display success, error, and info notifications"
  artifacts:
    - path: "src/components/ui/Button.tsx"
      provides: "Reusable button with variants, sizes, loading state, and disabled state"
      min_lines: 40
    - path: "src/components/ui/Input.tsx"
      provides: "Form input with label, error message, and react-hook-form compatibility"
      min_lines: 30
    - path: "src/components/ui/Modal.tsx"
      provides: "Overlay modal with close button, backdrop click, and escape key"
      min_lines: 40
    - path: "src/lib/utils/cn.ts"
      provides: "Tailwind class merging utility"
      contains: "clsx"
  key_links:
    - from: "src/components/ui/Input.tsx"
      to: "react-hook-form"
      via: "forwardRef for register()"
      pattern: "forwardRef"
    - from: "src/components/ui/Button.tsx"
      to: "src/lib/utils/cn.ts"
      via: "class merging"
      pattern: "import.*cn"
---

<objective>
Build the shared UI component library used by all subsequent plans.

Purpose: Every feature plan (auth forms, onboarding, daily content, profile, settings) needs buttons, inputs, cards, modals, and feedback components. Building them once here prevents duplication and ensures visual consistency.
Output: A complete set of reusable UI primitives with dark mode support and Tailwind v4 styling.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/01-foundation/01-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create utility function and core UI components (Button, Input, Card)</name>
  <files>
    src/lib/utils/cn.ts
    src/components/ui/Button.tsx
    src/components/ui/Input.tsx
    src/components/ui/Card.tsx
  </files>
  <action>
Install clsx and tailwind-merge for class name utility:
```bash
npm install clsx tailwind-merge
```

Create `src/lib/utils/cn.ts`:
```typescript
import { clsx, type ClassValue } from 'clsx';
import { twMerge } from 'tailwind-merge';
export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
```

Create `src/components/ui/Button.tsx`:
- "use client" directive
- Props: variant (primary | secondary | outline | ghost | danger), size (sm | md | lg), loading (boolean), disabled (boolean), fullWidth (boolean), children, and all native button HTML attributes
- Variants with Tailwind classes:
  - primary: bg-primary text-white hover:bg-primary-dark
  - secondary: bg-slate-100 text-slate-700 hover:bg-slate-200, dark: bg-slate-700 text-slate-200
  - outline: border border-border text-text hover:bg-slate-50, dark: border-border-dark text-text-dark
  - ghost: text-text hover:bg-slate-100, dark: text-text-dark hover:bg-slate-800
  - danger: bg-red-500 text-white hover:bg-red-600
- Sizes: sm (px-3 py-1.5 text-sm), md (px-4 py-2 text-base), lg (px-6 py-3 text-lg)
- Loading state shows a spinner SVG and disables the button
- fullWidth applies w-full
- Rounded corners (rounded-xl), transition, focus-visible ring
- Use cn() for class merging

Create `src/components/ui/Input.tsx`:
- "use client" directive
- Must use React.forwardRef to integrate with react-hook-form's register()
- Props: label (string), error (string), type, placeholder, and all native input HTML attributes
- Layout: label above input, error message below (red text)
- Styling: w-full px-4 py-3 rounded-xl border border-border bg-surface text-text, dark variants
- Error state: border-red-500, error text below
- Focus: ring-2 ring-primary/50 border-primary
- Disabled: opacity-60 cursor-not-allowed

Create `src/components/ui/Card.tsx`:
- "use client" directive
- Props: children, className, padding (sm | md | lg), hoverable (boolean)
- Styling: bg-surface rounded-2xl shadow-sm border border-border, dark: bg-surface-dark border-border-dark
- Hoverable: hover:shadow-md transition-shadow
- Padding: sm (p-3), md (p-4), lg (p-6)
  </action>
  <verify>
Create a temporary test page at `src/app/test-ui/page.tsx` that renders each component in multiple variants. Visit http://localhost:3000/test-ui and confirm:
1. All button variants render with correct colors
2. Input shows label and error message
3. Card renders with shadow and rounded corners
4. All components look correct (no missing styles)
  </verify>
  <done>Button with 5 variants + 3 sizes + loading state, Input with forwardRef + error display, Card with padding variants -- all rendering with dark mode support.</done>
</task>

<task type="auto">
  <name>Task 2: Create Modal, Skeleton, Toast, common components, and barrel export</name>
  <files>
    src/components/ui/Modal.tsx
    src/components/ui/Skeleton.tsx
    src/components/ui/Toast.tsx
    src/components/ui/index.ts
    src/components/common/LoadingSpinner.tsx
    src/components/common/EmptyState.tsx
    src/components/common/ErrorBoundary.tsx
  </files>
  <action>
Create `src/components/ui/Modal.tsx`:
- "use client" directive
- Props: isOpen (boolean), onClose (function), title (string), children, size (sm | md | lg)
- Renders a backdrop overlay (bg-black/50) with centered content panel
- Close on: backdrop click, Escape key (useEffect with keydown listener), X button in top-right
- Sizes: sm (max-w-sm), md (max-w-md), lg (max-w-lg)
- Animate in/out: Use CSS transitions or simple conditional rendering
- Use React Portal (createPortal to document.body) to escape stacking context
- Trap focus inside modal when open (basic: autoFocus on first focusable element)
- Styling: bg-surface rounded-2xl shadow-xl, dark: bg-surface-dark

Create `src/components/ui/Skeleton.tsx`:
- Props: className, width, height, rounded (boolean for full circle)
- Renders animated pulse placeholder: bg-slate-200 animate-pulse rounded-lg, dark: bg-slate-700
- Variants: SkeletonText (multiple lines), SkeletonCircle (avatar placeholder), SkeletonCard (full card shape)
- Export named variants and base Skeleton

Create `src/components/ui/Toast.tsx`:
- "use client" directive
- Simple toast notification system using React context
- ToastProvider wraps app, provides `toast()` function via useToast() hook
- Toast types: success (green), error (red), info (blue), warning (yellow)
- Each toast shows icon (from lucide-react: CheckCircle, XCircle, Info, AlertTriangle) + message
- Auto-dismiss after 4 seconds
- Stack multiple toasts vertically (fixed bottom-right or top-right)
- Render in a portal
- Export: ToastProvider, useToast hook

Create `src/components/ui/index.ts` barrel export:
```typescript
export { Button } from './Button';
export { Input } from './Input';
export { Card } from './Card';
export { Modal } from './Modal';
export { Skeleton, SkeletonText, SkeletonCircle, SkeletonCard } from './Skeleton';
export { ToastProvider, useToast } from './Toast';
```

Create `src/components/common/LoadingSpinner.tsx`:
- Simple centered spinner component using an SVG animation
- Props: size (sm | md | lg), className
- Used for full-page loading and inline loading states

Create `src/components/common/EmptyState.tsx`:
- Props: icon (ReactNode), title (string), description (string), action (ReactNode -- optional button)
- Centered layout with muted text
- Used when lists are empty (no daily posts, no categories, etc.)

Create `src/components/common/ErrorBoundary.tsx`:
- React error boundary (class component -- still required for error boundaries)
- Catches render errors and displays friendly error UI with "Try again" button
- Logs error to console (production logging deferred)

Delete the temporary `src/app/test-ui/page.tsx` test page (or keep it for ongoing development reference -- Claude's discretion).
  </action>
  <verify>
1. Update the test page to include Modal (open/close), Skeleton variants, and Toast (trigger toast.success/error/info).
2. Visit http://localhost:3000/test-ui and confirm:
   - Modal opens centered, closes on backdrop click and Escape key
   - Skeleton shows animated pulse placeholder
   - Toast appears in corner and auto-dismisses
   - LoadingSpinner renders centered
   - EmptyState shows icon + title + description
3. `npm run build` succeeds with zero TypeScript errors.
  </verify>
  <done>Complete UI component library: Button, Input, Card, Modal, Skeleton, Toast, LoadingSpinner, EmptyState, ErrorBoundary -- all with dark mode support, exported via barrel file.</done>
</task>

</tasks>

<verification>
1. All components import cleanly from 'src/components/ui'
2. Dark mode classes are present in all components (using theme custom properties or dark: variant)
3. Input component works with react-hook-form register() via forwardRef
4. Toast context provides useToast() hook
5. Modal traps focus and closes on Escape
6. `npm run build` passes
</verification>

<success_criteria>
- 6 UI primitives (Button, Input, Card, Modal, Skeleton, Toast) with consistent styling
- 3 common components (LoadingSpinner, EmptyState, ErrorBoundary)
- All components support dark mode via Tailwind v4 custom variant
- Input compatible with react-hook-form
- Toast system with context provider and hook
- Barrel export for clean imports
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-03-SUMMARY.md`
</output>
