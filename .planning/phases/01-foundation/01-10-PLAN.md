---
phase: 01-foundation
plan: 10
type: execute
wave: 5
depends_on: ["01-04", "01-09"]
files_modified:
  - src/app/(app)/page.tsx
  - src/app/(app)/daily/[date]/page.tsx
  - src/components/daily/DailyPostCarousel.tsx
  - src/components/daily/DailyPostSlide.tsx
  - src/components/daily/AudioPlayerSlide.tsx
  - src/components/daily/SubtitleDisplay.tsx
  - src/components/daily/LumaShortSlide.tsx
  - src/components/daily/TranslationSwitcher.tsx
  - src/components/daily/ShareButton.tsx
  - src/components/daily/DateNavigator.tsx
autonomous: false

must_haves:
  truths:
    - "User sees full-screen daily post with video background and verse/quote overlay"
    - "User can swipe horizontally between 3 slides (post, audio, video)"
    - "User can switch Bible translations on-screen and text updates"
    - "Audio player plays chapter audio with synced subtitle highlighting"
    - "User can navigate to previous days (never future)"
  artifacts:
    - path: "src/components/daily/DailyPostCarousel.tsx"
      provides: "3-slide Swiper carousel for daily content"
      contains: "Swiper"
    - path: "src/components/daily/DailyPostSlide.tsx"
      provides: "Slide 1: video background with verse overlay"
      contains: "video.*autoplay.*muted"
    - path: "src/components/daily/AudioPlayerSlide.tsx"
      provides: "Slide 2: audio player with SRT subtitle sync"
      contains: "audio"
    - path: "src/components/daily/TranslationSwitcher.tsx"
      provides: "Translation selector dropdown/buttons"
      contains: "translation"
  key_links:
    - from: "src/components/daily/DailyPostCarousel.tsx"
      to: "src/hooks/useDailyContent.ts"
      via: "fetches daily content data"
      pattern: "useDailyContent"
    - from: "src/components/daily/AudioPlayerSlide.tsx"
      to: "src/components/daily/SubtitleDisplay.tsx"
      via: "passes current time for subtitle sync"
      pattern: "currentTime|onTimeUpdate"
    - from: "src/app/(app)/page.tsx"
      to: "src/components/daily/DailyPostCarousel.tsx"
      via: "renders carousel as main content"
      pattern: "DailyPostCarousel"
---

<objective>
Build the 3-slide immersive daily content experience: video background with verse overlay, audio player with SRT karaoke highlighting, LumaShort video player, translation switcher, share card generation, and date navigation.

Purpose: The daily post is THE core feature users interact with every day. This is the immersive, full-screen experience that makes Free Luma special: swipeable slides with video backgrounds, karaoke-style audio, and discussion videos.
Output: Complete 3-slide daily post carousel with all interactive elements.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-04-SUMMARY.md
@.planning/phases/01-foundation/01-09-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Slide 1 (video bg + verse), Swiper carousel, translation switcher, date nav</name>
  <files>
    src/app/(app)/page.tsx
    src/app/(app)/daily/[date]/page.tsx
    src/components/daily/DailyPostCarousel.tsx
    src/components/daily/DailyPostSlide.tsx
    src/components/daily/TranslationSwitcher.tsx
    src/components/daily/DateNavigator.tsx
    src/components/daily/ShareButton.tsx
  </files>
  <action>
Create `src/components/daily/DailyPostCarousel.tsx`:
- "use client" directive
- Import Swiper, SwiperSlide from 'swiper/react'
- Import Pagination module from 'swiper/modules'
- Import CSS: 'swiper/css' and 'swiper/css/pagination'
- Props: date (optional string -- for historical view)
- Uses useDailyContent(date) hook to fetch content
- Loading state: Full-screen skeleton with pulsing gradient
- Error state: EmptyState with "No content for today" message
- Swiper config: slidesPerView=1, pagination={clickable: true, type: 'bullets'}, keyboard={enabled: true}, className="h-screen w-full"
- Three SwiperSlides: DailyPostSlide, AudioPlayerSlide, LumaShortSlide
- Pass content data and translation functions to each slide
- Pagination dots styled: white dots at bottom center

Create `src/components/daily/DailyPostSlide.tsx`:
- "use client" directive
- Full-screen slide with MP4 video background
- Video element: `<video autoPlay muted loop playsInline className="absolute inset-0 w-full h-full object-cover">` with source from content.video_background_url
- Poster attribute for fallback (first frame or placeholder image)
- Overlay: Semi-transparent dark gradient (bottom-heavy for text readability) using CSS gradient: `bg-gradient-to-t from-black/70 via-black/30 to-transparent`
- Content overlay (positioned over video, centered vertically):
  - TranslationSwitcher (top-right area)
  - Verse/quote text: Large, white, centered text with text shadow for readability. Use elegant serif font for Bible verses.
  - Verse reference below (e.g., "John 3:16" or "- Author Name")
  - ShareButton (bottom area)
  - DateNavigator (arrow buttons for previous day)
- If video_background_url is empty/placeholder: Show a gradient background instead (graceful fallback)

Create `src/components/daily/TranslationSwitcher.tsx`:
- "use client" directive
- Props: translations (available codes), activeTranslation, onSwitch(code: string)
- Renders as a compact dropdown or horizontal pill/chip selector
- Show active translation highlighted
- Only visible in Bible mode (not positivity mode -- positivity quotes don't have translations)
- On selection: calls switchTranslation from useDailyContent hook via callback

Create `src/components/daily/DateNavigator.tsx`:
- "use client" directive
- Left arrow to go to previous day, right arrow for next day
- Right arrow disabled/hidden when viewing current date (never forward past today)
- Uses Next.js router to navigate to /daily/YYYY-MM-DD for historical dates
- Current date displays at top or bottom (formatted: "February 11, 2026")
- On current date (today): no right arrow visible
- Subtle positioning: left/right edges of the screen or as a header element

Create `src/components/daily/ShareButton.tsx`:
- "use client" directive
- Share icon button (lucide-react Share2 icon)
- On click: Uses html-to-image to capture the verse overlay area as a PNG
- Generates a share card image: verse text + background color/gradient + "Free Luma" branding
- Then uses Web Share API (navigator.share) if available, or creates a download link
- Share card should include: verse text, reference, translation attribution if copyrighted, "FreeLuma.com" branding
- Fallback for desktop: Copy link + download image buttons

Update `src/app/(app)/page.tsx`:
- Replace placeholder with DailyPostCarousel (no date prop = today)
- This page should be full-screen (no internal padding -- video fills the viewport)
- Communicate to the AppShell that nav should be transparent on this page

Create `src/app/(app)/daily/[date]/page.tsx`:
- Renders DailyPostCarousel with date param
- Validate date format (YYYY-MM-DD)
- This route is for viewing historical daily posts
  </action>
  <verify>
1. Visit http://localhost:3000 (logged in) -- daily post carousel loads
2. If sample content has video URLs: video plays silently in background
3. If no video URLs: gradient fallback displays
4. Verse text overlaid on slide 1 with proper formatting
5. Translation switcher appears (bible mode) and switching updates text
6. Left arrow navigates to yesterday's post (/daily/2026-02-10)
7. Share button captures and generates image (or shows download option)
8. Swipe left to see slide 2 and 3 (may be placeholder until Task 2)
9. `npm run build` passes
  </verify>
  <done>Slide 1 complete: full-screen video background with verse overlay, translation switcher, date navigation arrows, share card generation. Swiper carousel wraps all 3 slides.</done>
</task>

<task type="auto">
  <name>Task 2: Slide 2 (audio + SRT karaoke) and Slide 3 (LumaShort video)</name>
  <files>
    src/components/daily/AudioPlayerSlide.tsx
    src/components/daily/SubtitleDisplay.tsx
    src/components/daily/LumaShortSlide.tsx
  </files>
  <action>
Create `src/components/daily/SubtitleDisplay.tsx`:
- "use client" directive
- Props: srtUrl (string), currentTime (number -- seconds from audio player)
- On mount: Fetch and parse SRT file using srt-parser-2
- Find active subtitle entry based on currentTime (entry where startSeconds <= currentTime <= endSeconds)
- Render:
  - Scrollable subtitle area showing full text
  - Active subtitle line highlighted (larger font, brighter color, or background highlight)
  - Previous/next lines visible but dimmed (karaoke-style scrolling effect)
- If no SRT URL provided: show "Subtitles not available" in muted text
- Use CSS transitions for smooth highlight transitions between subtitle lines

Create `src/components/daily/AudioPlayerSlide.tsx`:
- "use client" directive
- "iPhone Music app style" audio player (per CONTEXT.md)
- Layout (full slide):
  - Top: Title/chapter reference text
  - Center: SubtitleDisplay component (large, scrollable area for lyrics/text)
  - Bottom: Audio controls
- Audio controls (styled like iOS Music):
  - Progress bar (seekable -- click/drag to seek)
  - Current time / total duration labels
  - Play/Pause button (large, centered)
  - Rewind 15s and Forward 15s buttons flanking play/pause
  - Optional: playback speed selector (0.5x, 1x, 1.5x, 2x)
- Uses HTML5 `<audio>` element (hidden, controlled via ref)
- onTimeUpdate event feeds currentTime to SubtitleDisplay
- Background: Clean solid surface or subtle gradient (not video bg)
- If no audio_url: Show EmptyState "Audio not available for this day"

Create `src/components/daily/LumaShortSlide.tsx`:
- "use client" directive
- User-initiated playback (NOT autoplay per CONTEXT.md)
- Layout (full slide):
  - Video player centered with play button overlay
  - Title: "LumaShort" or chapter/content title
  - Video element: `<video playsInline controls>` with poster frame
  - Large play button overlay on poster (tap to start playback)
  - Once playing: controls visible (standard HTML5 video controls or custom)
- Background: Dark/clean surface
- If no lumashort_video_url: Show EmptyState "LumaShort not available for this day"

Styling guidelines for all slides:
- Each slide fills the full viewport height (h-screen or h-full within Swiper)
- Text uses white or light colors where on dark backgrounds
- Transitions between slides should be smooth (Swiper handles this)
- Safe area consideration: account for bottom nav (pb-16) and top bar (pt-14) where needed
- On the daily post tab specifically, nav overlays are semi-transparent, so slides should extend full screen
  </action>
  <verify>
1. Swipe to Slide 2 -- audio player renders with controls
2. If sample content has audio URL: Play button works, progress bar updates, subtitle text syncs
3. If no audio: "Audio not available" message shows
4. Swipe to Slide 3 -- LumaShort video shows play button overlay
5. Tap play -- video starts (user-initiated, not autoplay)
6. If no video: "LumaShort not available" message shows
7. Navigate between all 3 slides via swipe -- smooth transitions
8. `npm run build` passes
  </verify>
  <done>Complete 3-slide daily content experience: Slide 1 (video bg + verse), Slide 2 (audio player with SRT karaoke subtitles), Slide 3 (LumaShort video with user-initiated playback).</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete daily content 3-slide experience including video background, audio player with subtitle sync, LumaShort video, translation switching, date navigation, and share card generation.</what-built>
  <how-to-verify>
1. Open http://localhost:3000 (logged in as a user who completed onboarding)
2. Verify Slide 1: Full-screen display with verse/quote text overlaid. Translation switcher visible for bible mode.
3. Swipe left to Slide 2: Audio player with play/pause, progress bar, and subtitle area. Play audio if available.
4. Swipe left to Slide 3: Video with play button overlay. Tap to play.
5. Navigate to previous day using the left arrow on Slide 1.
6. Tap share button -- verify share card image is generated.
7. Check bottom nav and top bar are semi-transparent on this page.
8. Test on mobile viewport (Chrome DevTools responsive mode) -- touch swipe works.
9. Toggle dark mode -- verify the daily post page still looks good.
  </how-to-verify>
  <resume-signal>Type "approved" or describe any visual/functional issues to fix.</resume-signal>
</task>

</tasks>

<verification>
1. 3-slide Swiper carousel works with horizontal swipe
2. Video background autoplays (muted, looping, playsinline)
3. Translation switcher updates verse text
4. Audio player controls work (play, pause, seek)
5. SRT subtitles sync with audio playback
6. LumaShort requires user tap to play (not autoplay)
7. Date navigation works (previous days, no future)
8. Share card generates image
9. Full-screen experience with transparent nav overlays
</verification>

<success_criteria>
- 3-slide Swiper carousel: swipe navigation works on touch and keyboard
- Slide 1: MP4 video background (autoplay muted loop playsinline) with verse/quote overlay
- Slide 2: Audio player (iPhone Music style) with SRT karaoke subtitle highlighting
- Slide 3: LumaShort video with user-initiated playback
- Translation switcher (bible mode only) with live text update
- Date navigation (arrow to previous days, never forward past today)
- Share button generates image card with verse + branding
- Graceful fallback when media URLs missing
- Semi-transparent nav overlays on daily post page
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-10-SUMMARY.md`
</output>
