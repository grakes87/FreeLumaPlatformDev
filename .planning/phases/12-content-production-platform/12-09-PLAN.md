---
phase: 12-content-production-platform
plan: 09
type: execute
wave: 4
depends_on: ["12-06"]
files_modified:
  - src/components/admin/content-production/ContentProductionPage.tsx
  - src/components/admin/content-production/MonthSelector.tsx
  - src/components/admin/content-production/StatsHeader.tsx
  - src/components/admin/content-production/DayCard.tsx
  - src/components/admin/content-production/GenerationProgressModal.tsx
  - src/components/admin/content-production/UnassignedTab.tsx
  - src/components/admin/content-production/PendingTab.tsx
  - src/app/(admin)/admin/content-production/page.tsx
autonomous: true

must_haves:
  truths:
    - "Admin sees content production page with month/year selector and bible/positivity toggle"
    - "Stats header shows total days, generated, assigned, submitted, approved, missing"
    - "Unassigned tab shows days without content with Generate Month and per-day generate buttons"
    - "Pending tab shows days with missing fields with red X / green check badges"
    - "Generation progress modal streams real-time SSE progress in a scrolling log"
    - "DayCard expands to show all generated content fields"
  artifacts:
    - path: "src/components/admin/content-production/ContentProductionPage.tsx"
      provides: "Main page with 5 tabs and mode toggle"
      min_lines: 80
    - path: "src/components/admin/content-production/GenerationProgressModal.tsx"
      provides: "SSE progress modal overlay"
      min_lines: 60
    - path: "src/app/(admin)/admin/content-production/page.tsx"
      provides: "Admin content production page route"
      exports: ["default"]
  key_links:
    - from: "src/components/admin/content-production/GenerationProgressModal.tsx"
      to: "/api/admin/content-production/generate"
      via: "EventSource SSE connection"
      pattern: "EventSource|text/event-stream"
    - from: "src/components/admin/content-production/ContentProductionPage.tsx"
      to: "/api/admin/content-production"
      via: "fetches month overview data"
      pattern: "fetch.*content-production"
---

<objective>
Build the admin content production UI: main page with 5 tabs, month/mode selectors, stats header, Unassigned tab, Pending tab, DayCard component, and SSE generation progress modal.

Purpose: This is the primary admin interface for managing the content production pipeline. The Unassigned and Pending tabs are the most critical -- they let admin generate content and track completeness.
Output: Admin content production page with first 2 of 5 tabs functional plus core shared components.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/12-content-production-platform/12-CONTEXT.md
@src/app/(admin)/admin/verse-categories/page.tsx
@src/app/(admin)/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create admin page shell, MonthSelector, StatsHeader, and DayCard components</name>
  <files>
    src/app/(admin)/admin/content-production/page.tsx
    src/components/admin/content-production/ContentProductionPage.tsx
    src/components/admin/content-production/MonthSelector.tsx
    src/components/admin/content-production/StatsHeader.tsx
    src/components/admin/content-production/DayCard.tsx
  </files>
  <action>
**page.tsx** -- Admin route page:
Simple wrapper: `'use client'; import ContentProductionPage from '@/components/admin/content-production/ContentProductionPage'; export default function Page() { return <ContentProductionPage />; }`

**ContentProductionPage.tsx** -- Main page component:
- State: selectedMonth (YYYY-MM string, default current month), selectedMode ('bible' | 'positivity'), activeTab (1-5)
- Fetch data: useEffect fetches GET /api/admin/content-production?month={month}&mode={mode}. Store in state as { stats, days }.
- Refetch when month or mode changes.
- Layout:
  - Top: MonthSelector (left) + Bible/Positivity toggle buttons (right)
  - Below: StatsHeader with month stats
  - Tab bar: 5 tabs (Unassigned, Assigned, Pending, Completed, Background Videos)
  - Tab content: renders corresponding tab component
- Use Tailwind classes matching admin dashboard pattern (white cards, borders, padding)

**MonthSelector.tsx:**
- Left/right arrow buttons to navigate months
- Display: "March 2026" format
- onChange(month: string) callback
- Simple month picker -- no third-party date library needed

**StatsHeader.tsx:**
- Props: stats object { total_days, generated, assigned, submitted, approved, missing }
- Grid of 6 stat cards (2 rows x 3 cols on desktop, stack on mobile)
- Each card: number + label, color-coded (green for approved, yellow for pending, red for missing)

**DayCard.tsx:**
- Props: day data object (from API), onRegenerate callback, mode
- Collapsed state: date + status badge (color-coded by status) + creator name (if assigned)
- Expanded state (click to toggle):
  - All text fields: title, verse_reference, content_text, camera_script, devotional_reflection, meditation_script, background_prompt
  - Each field shown in a labeled section with the text content
  - Per-field "Regenerate" button next to each field header (calls onRegenerate with field name)
  - Translation status: list of translations with audio/SRT indicators
  - Creator video thumbnail preview (if exists)
  - Rejection note (if rejected, shown in red)
- No inline editing -- read-only with regenerate buttons (per CONTEXT)
  </action>
  <verify>Run `npx tsc --noEmit src/app/\\(admin\\)/admin/content-production/page.tsx src/components/admin/content-production/ContentProductionPage.tsx` to verify TypeScript compilation.</verify>
  <done>Admin content production page with month/year selector, bible/positivity toggle, stats header, and expandable DayCard showing all generated content with per-field regenerate buttons.</done>
</task>

<task type="auto">
  <name>Task 2: Create UnassignedTab, PendingTab, and GenerationProgressModal</name>
  <files>
    src/components/admin/content-production/UnassignedTab.tsx
    src/components/admin/content-production/PendingTab.tsx
    src/components/admin/content-production/GenerationProgressModal.tsx
  </files>
  <action>
**UnassignedTab.tsx:**
- Props: days (filtered to status='empty' or no content for that date), month, mode, onRefresh callback
- Shows list of dates that need content generation
- "Generate Month" button at top: opens GenerationProgressModal for bulk generation
- Per-day "Generate" button: opens GenerationProgressModal for single day
- Empty state: "All days have content generated" message with green checkmark

**PendingTab.tsx:**
- Props: days (filtered to status='generated' -- have content but missing some fields), onRegenerate callback
- For each day, shows a DayCard with field completeness indicators:
  - Green check or red X badge for each field: verse/quote, camera_script, devotional/meditation, background_prompt, audio (per translation), SRT (per translation), creator_video
  - Fields with red X get a "Regenerate" button
- "Regenerate All Missing" button at top: iterates missing fields and calls regenerate API for each
- Sort by most incomplete first (most red X badges)

**GenerationProgressModal.tsx:**
- Props: open (boolean), onClose, month, mode, day (optional -- null for full month)
- Uses Modal component (createPortal pattern) or a fixed overlay
- On open: creates EventSource to `/api/admin/content-production/generate` with query params
  - For POST with EventSource: since EventSource only does GET, use fetch with ReadableStream instead
  - Pattern: `const response = await fetch('/api/admin/content-production/generate', { method: 'POST', body: JSON.stringify({ month, mode, day }), headers: { 'Content-Type': 'application/json' } }); const reader = response.body.getReader(); const decoder = new TextDecoder();` then read chunks, parse SSE events from chunks
- Scrolling log area: shows each progress event as a line
  - Format: "Day 5/31: Generating verse..." with step description
  - Auto-scroll to bottom on new entries
- Color-coded entries: progress=gray, error=red, complete=green
- Close button (disabled while generating, enabled when complete)
- On complete: show summary (X generated, Y failed) and call onClose to refresh parent
  </action>
  <verify>Run `npx tsc --noEmit src/components/admin/content-production/UnassignedTab.tsx src/components/admin/content-production/PendingTab.tsx src/components/admin/content-production/GenerationProgressModal.tsx` for TypeScript check.</verify>
  <done>UnassignedTab shows empty dates with generate buttons. PendingTab shows field completeness with red X / green check badges. GenerationProgressModal streams SSE progress with scrolling log and auto-scroll.</done>
</task>

</tasks>

<verification>
- Admin content production page renders with 5 tab headers
- MonthSelector navigates between months
- StatsHeader shows all 6 stat categories
- DayCard expands/collapses with full content view
- UnassignedTab filters and displays empty dates
- PendingTab shows field completeness badges
- GenerationProgressModal connects to SSE endpoint and displays real-time progress
</verification>

<success_criteria>
- Content production page accessible at /admin/content-production
- Month/year navigation and bible/positivity toggle work
- Stats header accurately reflects month data
- DayCard shows all generated fields read-only with regenerate buttons
- Unassigned tab shows dates needing content with bulk and per-day generate
- Pending tab shows incomplete days with field-level status indicators
- Generation progress modal streams real-time progress log
</success_criteria>

<output>
After completion, create `.planning/phases/12-content-production-platform/12-09-SUMMARY.md`
</output>
