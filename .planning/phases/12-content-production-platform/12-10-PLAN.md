---
phase: 12-content-production-platform
plan: 10
type: execute
wave: 4
depends_on: ["12-06"]
files_modified:
  - src/components/admin/content-production/AssignedTab.tsx
  - src/components/admin/content-production/CompletedTab.tsx
  - src/components/admin/content-production/BackgroundVideosTab.tsx
  - src/components/admin/content-production/CreatorManager.tsx
autonomous: true

must_haves:
  truths:
    - "Assigned tab shows creator assignments with per-day and per-creator views"
    - "Admin can auto-assign and reassign creators from Assigned tab"
    - "Completed tab shows fully-filled content with approve action and immersive preview"
    - "Background Videos tab supports bulk upload with date-matching filename convention"
    - "Creator manager shows CRUD interface for LumaShortCreator records"
  artifacts:
    - path: "src/components/admin/content-production/AssignedTab.tsx"
      provides: "Creator assignments view with reassign capability"
      min_lines: 60
    - path: "src/components/admin/content-production/CompletedTab.tsx"
      provides: "Completed content review with approve action"
      min_lines: 60
    - path: "src/components/admin/content-production/BackgroundVideosTab.tsx"
      provides: "Background video upload interface"
      min_lines: 40
    - path: "src/components/admin/content-production/CreatorManager.tsx"
      provides: "Creator CRUD UI component"
      min_lines: 80
  key_links:
    - from: "src/components/admin/content-production/AssignedTab.tsx"
      to: "/api/admin/content-production/assign"
      via: "auto-assign and reassign API calls"
      pattern: "fetch.*assign"
    - from: "src/components/admin/content-production/CompletedTab.tsx"
      to: "/api/admin/content-production/review"
      via: "approve/reject/revert API calls"
      pattern: "fetch.*review"
---

<objective>
Build the remaining 3 admin tabs (Assigned, Completed, Background Videos) and the Creator Manager component.

Purpose: Assigned tab manages creator distribution. Completed tab is the approval workflow. Background Videos handles video uploads. Creator Manager is the CRUD interface for managing creator profiles.
Output: 4 components completing the admin content production UI.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/12-content-production-platform/12-CONTEXT.md
@src/components/admin/content-production/ContentProductionPage.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AssignedTab and CompletedTab</name>
  <files>
    src/components/admin/content-production/AssignedTab.tsx
    src/components/admin/content-production/CompletedTab.tsx
  </files>
  <action>
**AssignedTab.tsx:**
- Props: days (filtered to those with creator_id), month, mode, creators (list of all creators), onRefresh
- View toggle: "By Day" (default) and "By Creator"
- **By Day view:** List of DayCards showing date + creator name + status. Each day has a dropdown selector to change creator (calls reassign API on change).
- **By Creator view:** Group days by creator. Each creator section shows: name, avatar, assigned count / capacity, list of their assigned dates.
- "Auto-Assign" button at top: calls POST /api/admin/content-production/assign { action: 'auto_assign', month, mode }. Shows result toast (X assigned, Y skipped).
- Reassign: dropdown next to each day with all eligible creators for that mode. On select, calls POST /api/admin/content-production/assign { action: 'reassign', daily_content_id, creator_id }. Refresh list.

**CompletedTab.tsx:**
- Props: days (filtered to status='submitted' OR status='approved'), onRefresh
- Split into two sections: "Awaiting Review" (submitted) and "Approved" (approved)
- **Awaiting Review section:**
  - Each item shows: date, creator name, video thumbnail preview, camera script snippet
  - "Preview" button: opens a modal/overlay showing the 3-slide daily experience preview (verse slide + meditation/devotional slide + video slide). Keep this simple -- just show the generated content in a vertical layout simulating the daily experience. Not a full interactive carousel.
  - "Approve" button (green): calls POST /api/admin/content-production/review { daily_content_id, action: 'approve' }. Refreshes list.
  - "Reject" button (red): opens small text input for rejection_note, then calls POST /api/admin/content-production/review { daily_content_id, action: 'reject', rejection_note }. Refreshes list.
- **Approved section:**
  - Each item shows: date, creator name, "APPROVED" badge
  - "Revert" button (amber): calls POST /api/admin/content-production/review { daily_content_id, action: 'revert' } to un-approve (sets back to submitted)
- One-at-a-time approval per CONTEXT (no bulk approve button)
  </action>
  <verify>Run `npx tsc --noEmit src/components/admin/content-production/AssignedTab.tsx src/components/admin/content-production/CompletedTab.tsx` for TypeScript check.</verify>
  <done>AssignedTab shows per-day and per-creator views with auto-assign and reassign capability. CompletedTab shows awaiting review and approved sections with approve/reject/revert actions.</done>
</task>

<task type="auto">
  <name>Task 2: Create BackgroundVideosTab and CreatorManager</name>
  <files>
    src/components/admin/content-production/BackgroundVideosTab.tsx
    src/components/admin/content-production/CreatorManager.tsx
  </files>
  <action>
**BackgroundVideosTab.tsx:**
- Props: days (all days for the month), month, onRefresh
- Shows grid of days with their current background video status:
  - Green indicator if video_background_url is set
  - Gray indicator if no background video
- File upload area at top:
  - Accepts multiple .mp4 files via native file input
  - Validates filenames match YYYY-MM-DD-background.mp4 convention
  - For each valid file:
    1. Get presigned URL for B2 upload (key: `daily-content-backgrounds/{filename}`)
    2. Upload file to B2 via PUT to presigned URL
    3. Call POST /api/admin/content-production/background-video with date + video_url
  - Show upload progress (file name + percentage)
  - Show results: X uploaded, Y failed (with error messages for invalid filenames)
- Below upload area: calendar grid of days showing which have background videos

**CreatorManager.tsx:**
- Props: onCreatorChange callback (to refresh parent data)
- Fetches creator list from GET /api/admin/content-production/creators
- Shows table/list of creators with: name, user (username + avatar), languages, capacity, mode flags (bible/positivity), AI flag, active status
- "Add Creator" button: opens form modal with fields:
  - User search/select (type username, shows matching users -- use simple fetch to /api/admin/users?search=)
  - Name, bio, 3 link fields
  - Languages multi-select (en, es checkboxes)
  - Monthly capacity (number input)
  - Bible/Positivity toggle checkboxes
  - Is AI checkbox (shows HeyGen avatar ID field when checked)
- Edit: click existing creator to open same form pre-filled
- Deactivate: button with confirmation, calls DELETE /api/admin/content-production/creators/[id]
- Show creator capacity usage: "12/15 assigned this month" next to each creator

Wire CreatorManager into the ContentProductionPage as a separate section (e.g., a "Creators" button in the top bar that opens CreatorManager as a modal or side panel).
  </action>
  <verify>Run `npx tsc --noEmit src/components/admin/content-production/BackgroundVideosTab.tsx src/components/admin/content-production/CreatorManager.tsx` for TypeScript check.</verify>
  <done>BackgroundVideosTab supports bulk upload with YYYY-MM-DD filename matching. CreatorManager provides full CRUD interface for creator profiles with capacity tracking.</done>
</task>

</tasks>

<verification>
- All 4 components compile without errors
- AssignedTab supports both view modes and reassignment
- CompletedTab separates submitted and approved with correct actions
- BackgroundVideosTab validates filenames and uploads to B2
- CreatorManager supports create/edit/deactivate with user search
</verification>

<success_criteria>
- Assigned tab shows by-day and by-creator views with auto-assign button
- Completed tab has approve/reject/revert workflow with preview
- Background Videos tab uploads and matches videos to dates by filename
- Creator Manager supports full CRUD with capacity tracking and mode flags
- All 5 tabs of admin content production UI are complete
</success_criteria>

<output>
After completion, create `.planning/phases/12-content-production-platform/12-10-SUMMARY.md`
</output>
