---
phase: 05-workshops
plan: 08
type: execute
wave: 4
depends_on: [05-03, 05-04]
files_modified:
  - src/app/(app)/workshops/page.tsx
  - src/components/workshop/WorkshopCard.tsx
  - src/components/workshop/WorkshopFilters.tsx
  - src/hooks/useWorkshops.ts
autonomous: true

must_haves:
  truths:
    - "User can view upcoming workshop schedule with cards showing title, host, date, category, and attendee count"
    - "User can filter workshops by category"
    - "User can toggle between upcoming and past workshops"
    - "User can see their own workshops (hosting and RSVP'd)"
  artifacts:
    - path: "src/app/(app)/workshops/page.tsx"
      provides: "Workshop browse/schedule page"
    - path: "src/components/workshop/WorkshopCard.tsx"
      provides: "Workshop schedule card component"
    - path: "src/hooks/useWorkshops.ts"
      provides: "Workshop listing hook with filters"
      exports: ["useWorkshops"]
  key_links:
    - from: "src/app/(app)/workshops/page.tsx"
      to: "src/hooks/useWorkshops.ts"
      via: "useWorkshops hook"
      pattern: "useWorkshops"
    - from: "src/hooks/useWorkshops.ts"
      to: "/api/workshops"
      via: "fetch"
      pattern: "fetch.*api/workshops"
---

<objective>
Create the workshop browse/schedule page with workshop cards, category filtering, upcoming/past toggle, and "My Workshops" tab. This is the main entry point for discovering workshops.

Purpose: Users need to browse upcoming workshops, filter by category, and find their scheduled events.
Output: Workshop browse page, card component, filters, and data hook.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/05-workshops/05-CONTEXT.md
@src/app/(app)/watch/page.tsx
@src/components/video/VideoCard.tsx
@src/hooks/useFeed.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: useWorkshops hook and WorkshopCard component</name>
  <files>src/hooks/useWorkshops.ts, src/components/workshop/WorkshopCard.tsx</files>
  <action>
    **useWorkshops.ts:**
    Create a data fetching hook for workshop listing.

    ```typescript
    export function useWorkshops(options?: {
      category?: number;
      past?: boolean;
      my?: boolean;
      host?: number;
    })
    ```

    Returns: {
      workshops: Workshop[],
      isLoading: boolean,
      error: string | null,
      hasMore: boolean,
      loadMore: () => void,
      refresh: () => void,
    }

    Implementation:
    - Fetch from /api/workshops with query params based on options
    - Cursor-based pagination using useInfiniteScroll pattern (or manual)
    - Auto-fetch on mount and when options change
    - Append results on loadMore

    Define Workshop type matching API response shape.

    **WorkshopCard.tsx:**
    Card component for displaying a workshop in the browse list.

    Props: { workshop: Workshop, onPress?: () => void }

    Display:
    - Title (prominent, truncated to 2 lines)
    - Host info: avatar (InitialsAvatar or image) + display_name
    - Category badge (colored pill if category exists)
    - Scheduled date/time: formatted using date-fns (e.g., "Mon, Feb 16 at 7:00 PM")
    - Duration estimate if set (e.g., "~60 min")
    - Attendee count with People icon (e.g., "23 attending")
    - Status indicator:
      - scheduled: shows date
      - lobby: yellow "Starting soon" badge
      - live: pulsing red "LIVE" badge
      - ended: gray "Ended" badge
    - Private indicator: lock icon if is_private
    - Recurring indicator: repeat icon if series_id exists

    Styling:
    - Use Card component from src/components/ui
    - Tailwind classes with cn() for conditional styling
    - Dark mode support via dark: variants
    - Clickable card that navigates to /workshops/[id]
    - Mobile-first layout (full width on mobile, grid on desktop)
  </action>
  <verify>TypeScript compiles. WorkshopCard renders all key info. useWorkshops fetches and paginates.</verify>
  <done>Workshop card component and data hook ready for browse page.</done>
</task>

<task type="auto">
  <name>Task 2: Workshop browse page with filters</name>
  <files>src/app/(app)/workshops/page.tsx, src/components/workshop/WorkshopFilters.tsx</files>
  <action>
    **WorkshopFilters.tsx:**
    Filter bar component for workshop listing.

    Display:
    - Tab row: "Upcoming" | "Past" | "My Workshops" (horizontal scrollable)
    - Category filter: horizontal scrollable chip/pill row showing all categories (fetch from /api/workshops/categories)
    - "All" chip selected by default, selecting a category filters the list

    Props: {
      tab: 'upcoming' | 'past' | 'my',
      onTabChange: (tab) => void,
      categoryId: number | null,
      onCategoryChange: (id: number | null) => void,
      categories: WorkshopCategory[],
    }

    **workshops/page.tsx:**
    Main workshop browse page.

    'use client' component.

    Layout:
    - Page title "Workshops" with optional "Host a Workshop" button (if user.can_host)
    - WorkshopFilters at top
    - Workshop list: mapped WorkshopCard components
    - Empty state: "No upcoming workshops" with illustration
    - Loading state: 3 skeleton cards
    - Infinite scroll for more workshops
    - "Host a Workshop" button links to /workshops/create

    Data flow:
    - useWorkshops hook with filter options from WorkshopFilters state
    - Fetch categories from /api/workshops/categories for filter pills
    - Tab state controls upcoming/past/my filter
    - Category chip controls category filter

    Navigation:
    - Clicking a WorkshopCard navigates to /workshops/[id] (use Next.js Link or router.push)
  </action>
  <verify>TypeScript compiles. Page renders workshop list with filters. Category and tab filters work. Empty state shows.</verify>
  <done>Workshop browse page displays upcoming workshops with category and tab filtering, linking to details.</done>
</task>

</tasks>

<verification>
1. /workshops page renders with workshop cards
2. Category filter chips filter the list
3. Upcoming/Past/My tabs switch content
4. "Host a Workshop" button visible for can_host users
5. WorkshopCard shows title, host, date, attendee count, status
6. Live workshops show pulsing "LIVE" badge
7. Infinite scroll loads more workshops
</verification>

<success_criteria>
- Workshop schedule is browsable and filterable
- Users can find upcoming workshops by category
- My Workshops tab shows user's hosted and RSVP'd workshops
- Live workshops are visually distinct with LIVE badge
- Mobile-first responsive layout
</success_criteria>

<output>
After completion, create `.planning/phases/05-workshops/05-08-SUMMARY.md`
</output>
