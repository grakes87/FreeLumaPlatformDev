---
phase: 05-workshops
plan: 10
type: execute
wave: 4
depends_on: [05-03, 05-04]
files_modified:
  - src/app/(app)/workshops/[id]/page.tsx
  - src/components/workshop/WorkshopDetail.tsx
  - src/components/workshop/RSVPButton.tsx
  - src/components/workshop/InviteUsersModal.tsx
autonomous: true

must_haves:
  truths:
    - "User can view workshop detail page with host info, description, schedule, and attendee count"
    - "User can RSVP to a workshop with a button toggle"
    - "Host can invite users to private workshops via a modal"
    - "Detail page shows series info and next session for recurring workshops"
  artifacts:
    - path: "src/app/(app)/workshops/[id]/page.tsx"
      provides: "Workshop detail page"
    - path: "src/components/workshop/WorkshopDetail.tsx"
      provides: "Workshop detail view component"
    - path: "src/components/workshop/RSVPButton.tsx"
      provides: "RSVP toggle button"
    - path: "src/components/workshop/InviteUsersModal.tsx"
      provides: "User invite modal for private workshops"
  key_links:
    - from: "src/app/(app)/workshops/[id]/page.tsx"
      to: "/api/workshops/[id]"
      via: "fetch GET"
      pattern: "api/workshops"
    - from: "src/components/workshop/RSVPButton.tsx"
      to: "/api/workshops/[id]/rsvp"
      via: "fetch POST/DELETE"
      pattern: "api/workshops.*rsvp"
---

<objective>
Create the workshop detail page showing full information, RSVP button, host profile, schedule, and invitation features for private workshops.

Purpose: Users need a detail view to learn about a workshop and RSVP. Hosts need to invite users to private workshops.
Output: Detail page, detail component, RSVP button, invite modal.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/05-workshops/05-CONTEXT.md
@src/app/(app)/post/[id]/page.tsx
@src/components/chat/UserPicker.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Workshop detail page and component</name>
  <files>src/app/(app)/workshops/[id]/page.tsx, src/components/workshop/WorkshopDetail.tsx</files>
  <action>
    **workshops/[id]/page.tsx:**
    'use client' page.

    - Fetch workshop detail from /api/workshops/[id]
    - Render WorkshopDetail component with data
    - Loading: skeleton placeholder
    - Error/404: show "Workshop not found"
    - If workshop is live: show "Join Workshop" button linking to /workshops/[id]/live

    **WorkshopDetail.tsx:**
    Comprehensive detail view component.

    Props: { workshop: WorkshopData, userRsvp: RsvpData | null, isHost: boolean }

    Layout (mobile-first, single column):
    1. **Header section:**
       - Category badge (colored pill)
       - Title (large font)
       - Status badge (Scheduled / Starting Soon / LIVE / Ended / Cancelled)
       - Private indicator (lock icon + "Invite only" text)

    2. **Host section:**
       - Host avatar + display_name + username
       - "View Profile" link to /profile/[username]
       - If series: "Part of [series title]" with link to series page

    3. **Schedule section:**
       - Calendar icon + formatted date (e.g., "Monday, February 16, 2026")
       - Clock icon + formatted time (e.g., "7:00 PM EST")
       - Duration estimate if set (e.g., "~60 minutes")
       - If series: "Repeats weekly on Mondays" (from rrule description)
       - Next session link if recurring

    4. **Description section:**
       - Full description text (whitespace-pre-wrap)

    5. **Attendees section:**
       - People icon + "[N] attending"
       - If host: "View Attendees" link
       - First 5 attendee avatars in a row (stacked/overlapping)

    6. **Actions section (fixed bottom on mobile):**
       - RSVPButton component
       - If host: "Edit" button, "Start Workshop" button (only when status=scheduled), "Invite" button (for private)
       - If workshop is live: large "Join Workshop" button
       - If ended and recording available: "Watch Recording" button linking to video library

    7. **Recording section (if ended + recording_url):**
       - "Recording Available" banner with play icon
       - Link to video library entry

    Styling:
    - Use Card, Button from src/components/ui
    - cn() for conditional classes
    - Dark mode support
    - Responsive: single column mobile, wider card on desktop
  </action>
  <verify>TypeScript compiles. Detail page fetches and renders all workshop info. Status-dependent buttons show correctly.</verify>
  <done>Workshop detail page shows complete information with host profile, schedule, and status-aware actions.</done>
</task>

<task type="auto">
  <name>Task 2: RSVP button and invite modal</name>
  <files>src/components/workshop/RSVPButton.tsx, src/components/workshop/InviteUsersModal.tsx</files>
  <action>
    **RSVPButton.tsx:**
    Toggle button for RSVP/un-RSVP.

    Props: {
      workshopId: number,
      initialRsvp: boolean, // whether user is currently RSVP'd
      workshopStatus: string, // only allow RSVP when 'scheduled'
      isHost: boolean, // hosts don't need to RSVP
      onRsvpChange?: (isRsvpd: boolean) => void,
    }

    Behavior:
    - If host: show "You're the host" (disabled, no action)
    - If workshopStatus !== 'scheduled': hide or show "RSVP closed"
    - If RSVP'd: show "Cancel RSVP" (outlined/secondary style), DELETE /api/workshops/[id]/rsvp
    - If not RSVP'd: show "RSVP" (primary style), POST /api/workshops/[id]/rsvp
    - Optimistic update: toggle immediately, revert on error
    - Show toast on error
    - Loading state on button during API call

    **InviteUsersModal.tsx:**
    Modal for inviting users to a private workshop.

    Follow the exact pattern from src/components/chat/UserPicker.tsx.

    Props: {
      workshopId: number,
      isOpen: boolean,
      onClose: () => void,
    }

    Layout:
    - Modal overlay (use Modal from src/components/ui or createPortal)
    - Search input to find users (search /api/users?q=query)
    - User list with avatar, name, username
    - Checkboxes for multi-select
    - "Invite Selected" button at bottom
    - Shows count of selected users

    Submission:
    - POST /api/workshops/[id]/invite with { userIds: [...] }
    - Toast success: "Invited N users"
    - Close modal on success
  </action>
  <verify>TypeScript compiles. RSVP toggles with optimistic update. Invite modal searches and sends invitations.</verify>
  <done>RSVP button handles toggle with proper state management. Invite modal allows host to invite users to private workshops.</done>
</task>

</tasks>

<verification>
1. /workshops/[id] displays full workshop detail
2. RSVP button toggles between RSVP and Cancel RSVP
3. Host sees "Edit" and "Start Workshop" buttons
4. Live workshops show "Join Workshop" button
5. Ended workshops with recordings show "Watch Recording"
6. Invite modal searches and invites users
7. Private workshop indicator visible
</verification>

<success_criteria>
- Workshop detail page shows all relevant information
- RSVP works with optimistic updates and proper validation
- Host controls visible only to host
- Status-aware action buttons
- Private workshop invitation flow complete
</success_criteria>

<output>
After completion, create `.planning/phases/05-workshops/05-10-SUMMARY.md`
</output>
