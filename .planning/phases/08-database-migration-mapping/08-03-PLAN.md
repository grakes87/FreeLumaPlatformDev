---
phase: 08-database-migration-mapping
plan: 03
type: execute
wave: 3
depends_on: ["08-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User has reviewed the migration-mapping.xlsx spreadsheet"
    - "User has made decisions on all NEEDS DECISION items or acknowledged them for later"
    - "Spreadsheet accurately reflects old-to-new schema mapping"
  artifacts: []
  key_links: []
---

<objective>
Human verification of the complete migration mapping spreadsheet. The user reviews the generated Excel file to confirm mapping accuracy, make decisions on flagged items, and validate that the deliverable is ready to feed into Phase 7 (Migration & Launch).

Purpose: The mapping spreadsheet is the primary deliverable of Phase 8. Human review ensures no tables or columns were missed, transformation rules are correct, and the 6+ NEEDS DECISION items get user input.

Output: User approval or revision requests for the mapping spreadsheet.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-database-migration-mapping/08-CONTEXT.md
@.planning/phases/08-database-migration-mapping/08-02-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete migration mapping spreadsheet (`migration-mapping.xlsx`) documenting all 24 non-workshop old database tables mapped to the new FreeLuma schema. The spreadsheet contains:

1. **Overview sheet** — All 29 old tables listed with mapped/skipped/needs-decision status and row counts
2. **24 table sheets** — Each with column-by-column mapping, transformation rules, sample data (5 rows), relationships, orphan detection, and data quality notes
3. **Key findings flagged:**
   - Password hash format conversion ($2y$ -> $2b$) with plaintext password detection
   - Posts table row count discrepancy (~42 in dump vs expected thousands)
   - 6+ NEEDS DECISION items requiring your input
   - Complex transformations documented for: users (30+ columns), posts (type split), chats (flat->relational), notifications (polymorphic collapse), dailypostusers (dual split)
  </what-built>
  <how-to-verify>
1. Open `migration-mapping.xlsx` in Excel, Numbers, or Google Sheets
2. Review the **Overview** sheet:
   - Confirm all old tables are accounted for (24 non-workshop + 5 excluded)
   - Check row counts look reasonable
3. Spot-check the **users** sheet:
   - Verify the first_name + last_name -> display_name merge rule
   - Confirm password hash $2y$ -> $2b$ transformation is documented
   - Check the NEEDS DECISION items (phone, bookmark_setting vs bible_setting, tile_category, top_slide_preference, comment_hidden)
4. Spot-check the **posts** sheet:
   - Verify the FEED/PRAYER_WALL -> text/prayer_request type mapping
   - Confirm media JSON -> post_media transformation documented
5. Review **NEEDS DECISION** items across all sheets (search for yellow-highlighted rows):
   - `verses` family (4 tables, ~7K interactions): keep, drop, or migrate?
   - `homescreen_tile_categories` (10 rows): relevant to new UI or drop?
   - `notes` (7 rows): create new table, drop, or convert?
   - `dailypostusercomments` (6,733 rows): daily comment reactions — extend schema or drop?
   - `users.phone`: preserve or drop?
   - `users.bookmark_setting` vs `bible_setting`: which maps to preferred_translation?
6. Check sample data rows look realistic (real values from the SQL dump, not placeholders)
7. Verify relationship sections at the bottom of each table sheet

**If issues found:** Describe what needs correction and type "revise: [description]"
**If everything looks good and NEEDS DECISION items acknowledged:** Type "approved"
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 8, or "revise: [description]" to request corrections</resume-signal>
</task>

</tasks>

<verification>
- User has opened and reviewed the spreadsheet
- User has confirmed mapping accuracy or requested revisions
- NEEDS DECISION items have been acknowledged (even if deferred to Phase 7)
</verification>

<success_criteria>
1. User confirms the spreadsheet is an accurate and complete mapping deliverable
2. All NEEDS DECISION items either resolved or explicitly deferred
3. Phase 8 deliverable is ready to feed into Phase 7 migration script development
</success_criteria>

<output>
After completion, create `.planning/phases/08-database-migration-mapping/08-03-SUMMARY.md`
</output>
