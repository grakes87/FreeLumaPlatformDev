---
phase: 13-sms-notifications
plan: 07
type: execute
wave: 4
depends_on: ["13-05", "13-06"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Application builds without errors"
    - "Phone number section visible in settings"
    - "OTP verification flow works end to end"
    - "SMS toggles appear after phone verification"
    - "SMS notifications dispatch when enabled"
  artifacts: []
  key_links: []
---

<objective>
Build verification and human UX verification for the SMS notification system.

Purpose: Ensure all Phase 13 components work together and the user experience is correct.
Output: Verified build + human-approved UX.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build verification and type check</name>
  <files></files>
  <action>
    Run full build to verify all Phase 13 changes compile and integrate correctly:

    ```bash
    npx next build
    ```

    If build fails:
    1. Read error messages carefully
    2. Fix TypeScript errors, import issues, or missing exports
    3. Re-run build until it passes

    Also verify:
    - `npx sequelize-cli db:migrate:status` shows migrations 094, 095, 096 as 'up'
    - No console errors during build related to SMS/phone/twilio imports
  </action>
  <verify>
    `npx next build` completes with exit code 0.
    No TypeScript errors.
  </verify>
  <done>Application builds successfully with all Phase 13 changes.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete SMS notification system:
    - Phone number input with international country code selector in settings
    - OTP verification flow (send code, enter 6-digit code, verify)
    - SMS notification toggles (global + per-category) visible after phone verification
    - SMS dispatch wired into notification pipeline
    - Admin analytics shows SMS delivery stats
  </what-built>
  <how-to-verify>
    1. Start the dev server: `npm run dev`
    2. Log in and go to Settings
    3. Verify "Phone Number" section appears above "Notifications"
    4. Enter a phone number using the country code selector
    5. Click "Send Verification Code" (in dev mode without Twilio configured, check console for simulated OTP log)
    6. Enter "000000" as the dev-mode OTP code and verify
    7. After verification, confirm green checkmark appears next to phone number
    8. Scroll to Notifications section — SMS Notifications subsection should now be visible
    9. Toggle "Enable SMS" on — per-category toggles should appear
    10. Toggle individual SMS categories and verify they save (check Network tab for PUT /api/settings calls)
    11. (Admin) Check /admin/analytics — SMS stats section should appear (likely all zeros if no SMS sent)
    12. Verify dark mode rendering of phone input and SMS toggles
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 13, or describe any issues to fix.</resume-signal>
</task>

</tasks>

<verification>
1. `npx next build` passes
2. Settings page renders phone section correctly
3. OTP flow works in dev mode
4. SMS toggles appear conditionally
5. Admin analytics shows SMS stats section
</verification>

<success_criteria>
- Build passes with zero errors
- Human verifies phone input, OTP flow, SMS toggles, and admin stats render correctly
- Dark mode compatible
- All settings auto-save
</success_criteria>

<output>
After completion, create `.planning/phases/13-sms-notifications/13-07-SUMMARY.md`
</output>
